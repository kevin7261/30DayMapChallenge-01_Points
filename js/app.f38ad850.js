(function(){"use strict";var e={2048:function(e,n,t){var a=t(5130),o=t(657),r=t(6768);const l={id:"app",class:"d-flex flex-column vh-100"},s={class:"d-flex flex-column overflow-hidden"};function i(e,n,t,a,o,i){const u=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.CE)("div",l,[(0,r.Lk)("div",s,[(0,r.bF)(u)])])}var u={name:"App",components:{},setup(){return{}}},c=t(1241);const d=(0,c.A)(u,[["render",i]]);var p=d,v=t(1387);const m={id:"app",class:"d-flex flex-column vh-100"},y={class:"flex-grow-1 overflow-hidden position-relative"};function f(e,n,t,a,o,l){const s=(0,r.g2)("MapTab");return(0,r.uX)(),(0,r.CE)("div",m,[(0,r.Lk)("div",y,[(0,r.bF)(s,{onMapReady:a.setMapInstance},null,8,["onMapReady"])])])}var g=t(4232);const b={id:"map-container",class:"h-100 w-100 position-relative bg-transparent z-0"},h={class:"position-absolute",style:{top:"50%",left:"0",transform:"translateY(-50%)","z-index":"1000",padding:"1rem"}},C={class:"bg-dark bg-opacity-75 rounded-3 p-3"},I={class:""},L={class:"d-flex flex-column gap-1"},w=["onClick"],T=["id"];function x(e,n,t,a,o,l){return(0,r.uX)(),(0,r.CE)("div",b,[(0,r.Lk)("div",h,[(0,r.Lk)("div",C,[(0,r.Lk)("div",I,[(0,r.Lk)("div",L,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.countries,(e=>((0,r.uX)(),(0,r.CE)("button",{key:e.layerId,type:"button",class:(0,g.C4)(["btn border-0 my-country-btn my-font-sm-white px-4 py-3 text-center",[a.selectedCountryId===e.layerId?"active":""]]),onClick:n=>a.navigateToCountry(e.layerId)},(0,g.v_)(e.layerName),11,w)))),128))])])])]),n[0]||(n[0]=(0,r.Lk)("div",{class:"position-absolute map-center-point"},[(0,r.Lk)("div",{class:"center-dot"})],-1)),(0,r.Lk)("div",{id:a.mapContainerId,ref:"mapContainer",class:"h-100 w-100"},null,8,T)])}t(8111),t(116),t(1701);var E=t(144),k=t(6886),M=t.n(k);t(4114);const P=(0,o.nY)("data",(()=>{const e=17,n=(0,E.KR)([{groupName:"世界國家",groupLayers:[{layerId:"taiwan",layerName:"TAIWAN",center:[25.0457,121.5196]},{layerId:"china",layerName:"CHINA",center:[39.89877,116.39167]},{layerId:"japan",layerName:"JAPAN",center:[35.684580490329374,139.77440880399962]},{layerId:"usa",layerName:"UNITED STATES",center:[38.89511,-77.03655]},{layerId:"france",layerName:"FRANCE",center:[48.8534,2.3488]},{layerId:"germany",layerName:"GERMANY",center:[52.5108,13.399]}]}]),t=e=>{for(const t of n.value)for(const n of t.groupLayers)if(n.layerId===e)return n;return null},a=()=>{const e=[];for(const t of n.value)e.push(...t.groupLayers);return e},o=(0,E.KR)(null),l=e=>{o.value=e},s=(0,E.KR)(null),i=e=>{s.value=e},u=n=>{const a=t(n);if(!a)return void console.error("❌ 找不到國家圖層:",n);if(!s.value)return console.error("❌ 地圖實例未準備就緒，等待地圖初始化..."),void setTimeout((()=>{s.value?(console.log("🌍 地圖已準備就緒，重新嘗試移動"),u(n)):console.error("❌ 地圖實例仍未準備就緒")}),1e3);const[o,r]=a.center,l=[o,r],i=e;try{s.value.setView(l,i,{animate:!1}),console.log(`🌍 成功導航到國家: ${a.layerName}，縮放等級: ${i}`)}catch(c){console.error("❌ 地圖導航失敗:",c)}};return{layers:n,findLayerById:t,getAllLayers:a,selectedFeature:o,setSelectedFeature:l,mapInstance:s,setMapInstance:i,navigateToCountry:u,visibleLayers:(0,r.EW)((()=>a())),FIXED_ZOOM_LEVEL:e}}),{persist:!0}),z=(0,o.nY)("define",{state:()=>({selectedBasemap:"google_satellite",basemaps:[{label:"Google Satellite",value:"google_satellite",url:"https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}"}]}),actions:{setSelectedBasemap(e){this.selectedBasemap=e}}});var A={name:"MapTab",props:{},emits:["map-ready"],setup(e,{emit:n}){const t=P(),a=z(),o=(0,E.KR)(null);let l=null,s=null;const i=(0,E.KR)(!1),u=(0,E.KR)(`leaflet-map-${Math.random().toString(36).substr(2,9)}`),c=(0,E.KR)("taiwan"),d=(0,r.EW)((()=>t.getAllLayers().length>0)),p=e=>{c.value=e,t.navigateToCountry(e)},v=(0,r.EW)((()=>t.getAllLayers())),m=()=>{if(!o.value)return!1;const e=o.value.getBoundingClientRect();if(0===e.width||0===e.height)return console.warn("[MapTab] 容器尺寸為零，延遲初始化"),!1;try{const e=t.findLayerById("taiwan"),[a,r]=e?e.center:[25.0457,121.5196];return l=M().map(o.value,{center:[a,r],zoom:t.FIXED_ZOOM_LEVEL,zoomControl:!1,attributionControl:!1,dragging:!0,touchZoom:!1,doubleClickZoom:!1,scrollWheelZoom:!1,boxZoom:!1,keyboard:!1,zoomSnap:0,zoomDelta:0}),l.on("zoomend",y),l.on("moveend",f),l.getPane("tilePane")&&(l.getPane("tilePane").style.zIndex=1e3),l.getPane("markerPane")&&(l.getPane("markerPane").style.zIndex=2e3),l.getPane("overlayPane")&&(l.getPane("overlayPane").style.zIndex=2100),l.getPane("popupPane").style.zIndex=2200,i.value=!0,n("map-ready",l),!0}catch(a){return console.error("[MapTab] 地圖創建失敗:",a),!1}},y=()=>{if(l){const e=l.getZoom();n("update:zoomLevel",e)}},f=()=>{if(l){const e=l.getCenter();n("update:currentCoords",{lat:e.lat,lng:e.lng})}},g=()=>{if(!l)return;s&&l.removeLayer(s);const e=a.basemaps.find((e=>e.value===a.selectedBasemap));e&&e.url&&(s=M().tileLayer(e.url,{attribution:"© Google",maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]}),l.addLayer(s))},b=()=>{},h=()=>{l&&setTimeout((()=>{l.invalidateSize()}),100)},C=()=>{let e=0;const n=20,t=()=>{e>=n?console.error("[MapTab] 地圖初始化失敗，已達到最大嘗試次數"):(e++,console.log(`[MapTab] 嘗試創建地圖 (${e}/${n})`),m()?(g(),b(),setTimeout((()=>{p("taiwan")}),500)):setTimeout(t,100))};t()};let I=null,L=null;const w=()=>{o.value&&window.ResizeObserver&&(I=new ResizeObserver((()=>{L&&clearTimeout(L),L=setTimeout((()=>{h()}),200)})),I.observe(o.value))};return(0,r.sV)((()=>{(0,r.dY)((()=>{C(),w()}))})),(0,r.hi)((()=>{L&&clearTimeout(L),I&&I.disconnect(),l&&(l.remove(),l=null),s=null,i.value=!1})),(0,r.wB)((()=>t.layers),b,{deep:!0}),(0,r.wB)((()=>a.selectedBasemap),(()=>{i.value&&g()})),{mapContainer:o,mapContainerId:u,isAnyLayerVisible:d,invalidateSize:h,defineStore:a,navigateToCountry:p,countries:v,selectedCountryId:c}}};const O=(0,c.A)(A,[["render",x]]);var _=O,N={name:"HomeView",components:{MapTab:_},setup(){const e=P(),n=z(),t=n=>e.setMapInstance(n),a=n=>{e.navigateToCountry(n)},o=(0,r.EW)((()=>e.getAllLayers()));return{setMapInstance:t,defineStore:n,navigateToCountry:a,countries:o}}};const R=(0,c.A)(N,[["render",f]]);var S=R;const B=[{path:"/",name:"Home",component:S}],F=(0,v.aE)({history:(0,v.LA)("/30DayMapChallenge-01_Points/"),routes:B});var K=F;t(323);const Z=(0,a.Ef)(p),j=(0,o.Ey)();Z.use(K),Z.use(j),Z.mount("#app")}},n={};function t(a){var o=n[a];if(void 0!==o)return o.exports;var r=n[a]={exports:{}};return e[a].call(r.exports,r,r.exports,t),r.exports}t.m=e,function(){var e=[];t.O=function(n,a,o,r){if(!a){var l=1/0;for(c=0;c<e.length;c++){a=e[c][0],o=e[c][1],r=e[c][2];for(var s=!0,i=0;i<a.length;i++)(!1&r||l>=r)&&Object.keys(t.O).every((function(e){return t.O[e](a[i])}))?a.splice(i--,1):(s=!1,r<l&&(l=r));if(s){e.splice(c--,1);var u=o();void 0!==u&&(n=u)}}return n}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[a,o,r]}}(),function(){t.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(n,{a:n}),n}}(),function(){t.d=function(e,n){for(var a in n)t.o(n,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:n[a]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}}(),function(){var e={524:0};t.O.j=function(n){return 0===e[n]};var n=function(n,a){var o,r,l=a[0],s=a[1],i=a[2],u=0;if(l.some((function(n){return 0!==e[n]}))){for(o in s)t.o(s,o)&&(t.m[o]=s[o]);if(i)var c=i(t)}for(n&&n(a);u<l.length;u++)r=l[u],t.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return t.O(c)},a=self["webpackChunk_30DayMapChallenge_01_Points"]=self["webpackChunk_30DayMapChallenge_01_Points"]||[];a.forEach(n.bind(null,0)),a.push=n.bind(null,a.push.bind(a))}();var a=t.O(void 0,[504],(function(){return t(2048)}));a=t.O(a)})();
//# sourceMappingURL=app.f38ad850.js.map